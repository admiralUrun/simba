@(customers: Seq[Customer], search: String)(implicit request: MessagesRequestHeader)
@import helper._

@header() = {
    @List("ID", "Ім'я", "Прізвище", "Телефон", "Телефон 2",
        "Місто", "Адреса", "Instagram", "Надає перевагу", "Нотатка").zipWithIndex.map{ case (header, i) =>
            <th class="col@{i + 1} header">
                @header
            </th>
    }
}

@formatString(o: Option[String], n: Option[String]) = @{
    o.map(p => p + n.map(n => s"($n)").getOrElse("")).getOrElse("")
}

@getFlashes = {
    @request.flash.get("success").map { message =>
        <div class="alert-success">
            <strong>Готово!</strong> @message
        </div>
    }
    @request.flash.get("error").map { message =>
        <div class="alert-danger">
            <strong>@message</strong>
        </div>
    }
}

@main("Клієнти") {
    @getFlashes

    <div class="container-fluid">
        <div class="row">
            @form(routes.CustomerController.toCustomersListPage("", ""), Symbol("class") -> "colFirst") {
                <div class="input-group col-md">
                    <input name="search" type="text" class="form-control col-md" value="@search" list="searchList" multiple>
                    <select name="searchSelect" class="dropdown-menu-md-right custom-select col-sm-2">
                        <option value="id">Id</option>
                        <option value="name">Ім'я</option>
                        <option value="lastName">Прізвише</option>
                        <option value="phones">Телофон</option>
                        <option value="instagram">Instagram</option>
                    </select>
                    <input type="submit" id="searchSubmit" value="Пошук" class="btn btn-primary offset-sm-1">
                </div>
            }
            <div class="col"></div>
            <a class="colLast btn btn-success" id="add" href="@routes.CustomerController.toCreateCustomerPage()">Додати</a>
        </div>
    </div>

    <div id="table">
        @if(customers.nonEmpty) {
        <table class="table table-striped table-bordered">
            <thead>
                <tr>@header()</tr>
            </thead>
            <tbody>
            @customers.map { c =>
                <tr>
                    <td><a href="@routes.CustomerController.toEditCustomerPage(c.id.head)">@c.id</a></td>
                    <td>@c.firstName</td>
                    <td>@c.lastName.getOrElse("-")</td>
                    <td>@formatString(Option(c.phone), c.phoneNote)</td>
                    <td>@formatString(c.phone2, c.phoneNote2)</td>
                    <td>@c.city</td>
                    <td>
                        @c.address,
                        @formatString(c.entrance, Option("Під'їзд"))
                        @formatString(c.floor, Option("Поверх"))
                        @formatString(c.flat, Option("Квартира"))
                    </td>
                    <td>@c.instagram.getOrElse("-")</td>
                    <td>@c.preferences.getOrElse("-")</td>
                    <td>@c.notes.getOrElse("-")</td>
                </tr>
            }
            </tbody>
        </table>
    } else {
        <h4 class="alert-info">Нікого немає, мяу</h4>
    }
    </div>
}
