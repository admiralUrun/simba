@import services.SimbaHTMLHelper._
@import java.util.Date
@(orders:Map[Date, List[OrderForDisplay]], search:String)(implicit request: MessagesRequestHeader)

    @getDateRow(d: Date) = {
        <tr>
            <td>
                <h4>@formattingDateForDisplay(d)</h4>
            </td>
        </tr>
    }

    @getCustomerDataForView(c: Customer) = @{
        def getSecondPhoneOrCloseBrace: String = if(c.phone2.nonEmpty)s", ${c.phone2})" else ")"
        s"${c.id}- ${c.firstName} ${c.lastName} (${c.phone}" + getSecondPhoneOrCloseBrace
    }

    @getAddressForView(a: Address) = @{
        s"Місто: ${a.city}, Адреса: ${a.address}, Під'їзд: ${getStringOrDash(a.entrance)}, Поверх: ${getStringOrDash(a.floor)}, Квартира: ${getStringOrDash(a.flat)}"
    }


    @formatBoolean(b:Boolean, trueLabel: String, falseLabel: String) = @{
        if(b) trueLabel else falseLabel
    }

@main("Замовлення") {

    @getFlash()

    @getStandardSearchDiv(Option(routes.OrderController.toOrderFeedPage("")), None, Option(routes.OrderController.toOrderCreatePage()), withSideJS = false)

    @getDateRow(new Date())
    <div id="table">
    @if(orders.nonEmpty) {
        <table class="table table-striped table-bordered">
            <thead>
                <tr>@tableHeaders(List("id", "Замовник", "Адреса", "Дата Замовлення", "Дата Доставки", "Сума", "Оплата", "Статус", "Нотатка"))</tr>
            </thead>
            <tbody>
            @orders.map { t =>
                @getDateRow(t._1)
              @t._2.map{ o =>
                  <tr>
                      <td>@o.id</td>
                      <td>@getCustomerDataForView(o.customer)</td>
                      <td>@getAddressForView(o.address)</td>
                      <td>@formattingDateForDisplay(o.orderDay)</td>
                      <td>@formattingDateForDisplay(o.deliveryDay)</td>
                      <td>@o.inOrder</td>
                      <td>@o.total</td>
                      <td>@formatBoolean(o.paid, "Оплаченно", "Не оплаченно")</td>
                      <td>@formatBoolean(o.delivered, "Доставленно", "Не Доставленно")</td>
                      <td>@o.note</td>
                  </tr>
              }
            }
            </tbody>
        </table>
    } else {
        <h4 class="alert-info">Як там бізнес?, мяу</h4>
    }
    </div>
}