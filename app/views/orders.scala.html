@import services.SimbaHTMLHelper._
@import java.util.Date
@(orders:Map[Date, Seq[OrderForDisplay]], search:String)(implicit request: MessagesRequestHeader)

    @getDateRow(d: Date) = {
        <div class="row  container-fluid">
            <h4>@formattingDateForDisplay(d)</h4>
        </div>
    }

    @getCustomerDataForView(c: Customer) = @{
        def getSecondPhoneOrCloseBrace: String = if(c.phone2.nonEmpty)s", ${c.phone2.getOrElse("")})" else ")"
        s"${c.id.head}- ${c.firstName} ${c.lastName.getOrElse("")} (${c.phone}" + getSecondPhoneOrCloseBrace
    }

    @getAddressForView(a: Address) = @{
        s"Місто: ${a.city}, Адреса: ${a.address}, Під'їзд: ${getStringOrDash(a.entrance)}, Поверх: ${getStringOrDash(a.floor)}, Квартира: ${getStringOrDash(a.flat)}"
    }


    @formatBoolean(b:Boolean, trueLabel: String, falseLabel: String) = @{
        if(b) trueLabel else falseLabel
    }

@main("Замовлення") {

    @getFlash()

    @getStandardSearchDiv(Option(routes.OrderController.toOrderFeedPage("")), None, Option(routes.OrderController.toOrderCreatePage()), withSideJS = false)

    <div id="table">
    @if(orders.nonEmpty) {
            @orders.map { t =>
                @getDateRow(t._1)
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>@tableHeaders(List("id", "Замовник", "Адреса", "Дата Замовлення", "Дата та Час Доставки", "У заміовлені", "Сума", "Оплата", "Статус", "Нотатка"), darkHead = true)</tr>
                    </thead>
                    <tbody>
              @t._2.map{ o =>
                  <tr>
                      <td><a href="@routes.OrderController.toOrderEditPage(o.id.head)">@o.id</a></td>
                      <td>@getCustomerDataForView(o.customer)</td>
                      <td>@getAddressForView(o.address)</td>
                      <td>@formattingDateForDisplay(o.orderDay)</td> @* TODO: Format Data to Display    *@
                      <td>
                      @formattingDateForDisplay(o.deliveryDay) –
                          З @o.deliverFrom по @o.deliverTo
                          @if(o.deliveryOnMonday) {
                              Доставка у Понеділок
                          }
                      </td>
                      <td>@o.inOrder</td>
                      <td>@o.total</td>
                      <td class="">@formatBoolean(o.paid, "Оплаченно", "Не оплаченно")</td> @* TODO: Add swithc classes   *@
                      <td>@formatBoolean(o.delivered, "Доставленно", "Не Доставленно")</td>
                      <td>@o.note</td>
                  </tr>
              }
            </tbody>
            </table>
            }
    } else {
        <h4 class="alert-info">Як там бізнес?, мяу</h4>
    }
    </div>
}